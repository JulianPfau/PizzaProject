<!doctype html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />

    <title>server API documentation</title>
    <meta name="description" content="" />

  <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:400,300' rel='stylesheet' type='text/css'>
  
  <style type="text/css">
  
* {
  box-sizing: border-box;
}
/*! normalize.css v1.1.1 | MIT License | git.io/normalize */

/* ==========================================================================
   HTML5 display definitions
   ========================================================================== */

/**
 * Correct `block` display not defined in IE 6/7/8/9 and Firefox 3.
 */

article,
aside,
details,
figcaption,
figure,
footer,
header,
hgroup,
main,
nav,
section,
summary {
    display: block;
}

/**
 * Correct `inline-block` display not defined in IE 6/7/8/9 and Firefox 3.
 */

audio,
canvas,
video {
    display: inline-block;
    *display: inline;
    *zoom: 1;
}

/**
 * Prevent modern browsers from displaying `audio` without controls.
 * Remove excess height in iOS 5 devices.
 */

audio:not([controls]) {
    display: none;
    height: 0;
}

/**
 * Address styling not present in IE 7/8/9, Firefox 3, and Safari 4.
 * Known issue: no IE 6 support.
 */

[hidden] {
    display: none;
}

/* ==========================================================================
   Base
   ========================================================================== */

/**
 * 1. Prevent system color scheme's background color being used in Firefox, IE,
 *    and Opera.
 * 2. Prevent system color scheme's text color being used in Firefox, IE, and
 *    Opera.
 * 3. Correct text resizing oddly in IE 6/7 when body `font-size` is set using
 *    `em` units.
 * 4. Prevent iOS text size adjust after orientation change, without disabling
 *    user zoom.
 */

html {
    background: #fff; /* 1 */
    color: #000; /* 2 */
    font-size: 100%; /* 3 */
    -webkit-text-size-adjust: 100%; /* 4 */
    -ms-text-size-adjust: 100%; /* 4 */
}

/**
 * Address `font-family` inconsistency between `textarea` and other form
 * elements.
 */

html,
button,
input,
select,
textarea {
    font-family: sans-serif;
}

/**
 * Address margins handled incorrectly in IE 6/7.
 */

body {
    margin: 0;
}

/* ==========================================================================
   Links
   ========================================================================== */

/**
 * Address `outline` inconsistency between Chrome and other browsers.
 */

a:focus {
    outline: thin dotted;
}

/**
 * Improve readability when focused and also mouse hovered in all browsers.
 */

a:active,
a:hover {
    outline: 0;
}

/* ==========================================================================
   Typography
   ========================================================================== */

/**
 * Address font sizes and margins set differently in IE 6/7.
 * Address font sizes within `section` and `article` in Firefox 4+, Safari 5,
 * and Chrome.
 */

h1 {
    font-size: 2em;
    margin: 0.67em 0;
}

h2 {
    font-size: 1.5em;
    margin: 0.83em 0;
}

h3 {
    font-size: 1.17em;
    margin: 1em 0;
}

h4 {
    font-size: 1em;
    margin: 1.33em 0;
}

h5 {
    font-size: 0.83em;
    margin: 1.67em 0;
}

h6 {
    font-size: 0.67em;
    margin: 2.33em 0;
}

/**
 * Address styling not present in IE 7/8/9, Safari 5, and Chrome.
 */

abbr[title] {
    border-bottom: 1px dotted;
}

/**
 * Address style set to `bolder` in Firefox 3+, Safari 4/5, and Chrome.
 */

b,
strong {
    font-weight: bold;
}

blockquote {
    margin: 1em 40px;
}

/**
 * Address styling not present in Safari 5 and Chrome.
 */

dfn {
    font-style: italic;
}

/**
 * Address differences between Firefox and other browsers.
 * Known issue: no IE 6/7 normalization.
 */

hr {
    -moz-box-sizing: content-box;
    box-sizing: content-box;
    height: 0;
}

/**
 * Address styling not present in IE 6/7/8/9.
 */

mark {
    background: #ff0;
    color: #000;
}

/**
 * Address margins set differently in IE 6/7.
 */

p,
pre {
    margin: 1em 0;
}

/**
 * Correct font family set oddly in IE 6, Safari 4/5, and Chrome.
 */

code,
kbd,
pre,
samp {
    font-family: monospace, serif;
    _font-family: 'courier new', monospace;
    font-size: 1em;
}

/**
 * Improve readability of pre-formatted text in all browsers.
 */

pre {
    white-space: pre;
    white-space: pre-wrap;
    word-wrap: break-word;
}

/**
 * Address CSS quotes not supported in IE 6/7.
 */

q {
    quotes: none;
}

/**
 * Address `quotes` property not supported in Safari 4.
 */

q:before,
q:after {
    content: '';
    content: none;
}

/**
 * Address inconsistent and variable font size in all browsers.
 */

small {
    font-size: 80%;
}

/**
 * Prevent `sub` and `sup` affecting `line-height` in all browsers.
 */

sub,
sup {
    font-size: 75%;
    line-height: 0;
    position: relative;
    vertical-align: baseline;
}

sup {
    top: -0.5em;
}

sub {
    bottom: -0.25em;
}

/* ==========================================================================
   Lists
   ========================================================================== */

/**
 * Address margins set differently in IE 6/7.
 */

dl,
menu,
ol,
ul {
    margin: 1em 0;
}

dd {
    margin: 0 0 0 40px;
}

/**
 * Address paddings set differently in IE 6/7.
 */

menu,
ol,
ul {
    padding: 0 0 0 40px;
}

/**
 * Correct list images handled incorrectly in IE 7.
 */

nav ul,
nav ol {
    list-style: none;
    list-style-image: none;
}

/* ==========================================================================
   Embedded content
   ========================================================================== */

/**
 * 1. Remove border when inside `a` element in IE 6/7/8/9 and Firefox 3.
 * 2. Improve image quality when scaled in IE 7.
 */

img {
    border: 0; /* 1 */
    -ms-interpolation-mode: bicubic; /* 2 */
}

/**
 * Correct overflow displayed oddly in IE 9.
 */

svg:not(:root) {
    overflow: hidden;
}

/* ==========================================================================
   Figures
   ========================================================================== */

/**
 * Address margin not present in IE 6/7/8/9, Safari 5, and Opera 11.
 */

figure {
    margin: 0;
}

/* ==========================================================================
   Forms
   ========================================================================== */

/**
 * Correct margin displayed oddly in IE 6/7.
 */

form {
    margin: 0;
}

/**
 * Define consistent border, margin, and padding.
 */

fieldset {
    border: 1px solid #c0c0c0;
    margin: 0 2px;
    padding: 0.35em 0.625em 0.75em;
}

/**
 * 1. Correct color not being inherited in IE 6/7/8/9.
 * 2. Correct text not wrapping in Firefox 3.
 * 3. Correct alignment displayed oddly in IE 6/7.
 */

legend {
    border: 0; /* 1 */
    padding: 0;
    white-space: normal; /* 2 */
    *margin-left: -7px; /* 3 */
}

/**
 * 1. Correct font size not being inherited in all browsers.
 * 2. Address margins set differently in IE 6/7, Firefox 3+, Safari 5,
 *    and Chrome.
 * 3. Improve appearance and consistency in all browsers.
 */

button,
input,
select,
textarea {
    font-size: 100%; /* 1 */
    margin: 0; /* 2 */
    vertical-align: baseline; /* 3 */
    *vertical-align: middle; /* 3 */
}

/**
 * Address Firefox 3+ setting `line-height` on `input` using `!important` in
 * the UA stylesheet.
 */

button,
input {
    line-height: normal;
}

/**
 * Address inconsistent `text-transform` inheritance for `button` and `select`.
 * All other form control elements do not inherit `text-transform` values.
 * Correct `button` style inheritance in Chrome, Safari 5+, and IE 6+.
 * Correct `select` style inheritance in Firefox 4+ and Opera.
 */

button,
select {
    text-transform: none;
}

/**
 * 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio`
 *    and `video` controls.
 * 2. Correct inability to style clickable `input` types in iOS.
 * 3. Improve usability and consistency of cursor style between image-type
 *    `input` and others.
 * 4. Remove inner spacing in IE 7 without affecting normal text inputs.
 *    Known issue: inner spacing remains in IE 6.
 */

button,
html input[type="button"], /* 1 */
input[type="reset"],
input[type="submit"] {
    -webkit-appearance: button; /* 2 */
    cursor: pointer; /* 3 */
    *overflow: visible;  /* 4 */
}

/**
 * Re-set default cursor for disabled elements.
 */

button[disabled],
html input[disabled] {
    cursor: default;
}

/**
 * 1. Address box sizing set to content-box in IE 8/9.
 * 2. Remove excess padding in IE 8/9.
 * 3. Remove excess padding in IE 7.
 *    Known issue: excess padding remains in IE 6.
 */

input[type="checkbox"],
input[type="radio"] {
    box-sizing: border-box; /* 1 */
    padding: 0; /* 2 */
    *height: 13px; /* 3 */
    *width: 13px; /* 3 */
}

/**
 * 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome.
 * 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome
 *    (include `-moz` to future-proof).
 */

input[type="search"] {
    -webkit-appearance: textfield; /* 1 */
    -moz-box-sizing: content-box;
    -webkit-box-sizing: content-box; /* 2 */
    box-sizing: content-box;
}

/**
 * Remove inner padding and search cancel button in Safari 5 and Chrome
 * on OS X.
 */

input[type="search"]::-webkit-search-cancel-button,
input[type="search"]::-webkit-search-decoration {
    -webkit-appearance: none;
}

/**
 * Remove inner padding and border in Firefox 3+.
 */

button::-moz-focus-inner,
input::-moz-focus-inner {
    border: 0;
    padding: 0;
}

/**
 * 1. Remove default vertical scrollbar in IE 6/7/8/9.
 * 2. Improve readability and alignment in all browsers.
 */

textarea {
    overflow: auto; /* 1 */
    vertical-align: top; /* 2 */
}

/* ==========================================================================
   Tables
   ========================================================================== */

/**
 * Remove most spacing between table cells.
 */

table {
    border-collapse: collapse;
    border-spacing: 0;
}

  </style>

  <style type="text/css">
  
  html, body {
    margin: 0;
    padding: 0;
    min-height: 100%;
  }
  body {
    background: #fff;
    font-family: "Source Sans Pro", "Helvetica Neueue", Helvetica, sans;
    font-weight: 300;
    font-size: 16px;
    line-height: 1.6em;
  }
  #content {
    width: 70%;
    max-width: 850px;
    float: left;
    padding: 30px 60px;
    border-left: 1px solid #ddd;
  }
  #sidebar {
    width: 25%;
    float: left;
    padding: 30px;
    overflow: hidden;
  }
  #nav {
    font-size: 130%;
    margin: 0 0 15px 0;
  }

  #top {
    display: block;
    position: fixed;
    bottom: 5px;
    left: 5px;
    font-size: .85em;
    text-transform: uppercase;
  }

  #footer {
    font-size: .75em;
    padding: 5px 30px;
    border-top: 1px solid #ddd;
    text-align: right;
  }
    #footer p {
      margin: 0 0 0 30px;
      display: inline-block;
    }

  h1, h2, h3, h4, h5 {
    font-weight: 300;
  }
  h1 {
    font-size: 2.5em;
    line-height: 1.1em;
    margin: 0 0 .50em 0;
  }

  h2 {
    font-size: 1.75em;
    margin: 1em 0 .50em 0;
  }

  h3 {
    margin: 25px 0 10px 0;
  }

  h4 {
    margin: 0;
    font-size: 105%;
  }

  a {
    color: #058;
    text-decoration: none;
    transition: color .3s ease-in-out;
  }

  a:hover {
    color: #e08524;
    transition: color .3s ease-in-out;
  }

  pre, code, .mono, .name {
    font-family: "Ubuntu Mono", "Cousine", "DejaVu Sans Mono", monospace;
  }

  .title .name {
    font-weight: bold;
  }
  .section-title {
    margin-top: 2em;
  }
  .ident {
    color: #900;
  }

  code {
    background: #f9f9f9;
  } 

  pre {
    background: #fefefe;
    border: 1px solid #ddd;
    box-shadow: 2px 2px 0 #f3f3f3;
    margin: 0 30px;
    padding: 15px 30px;
  }

  .codehilite {
    margin: 0 30px 10px 30px;
  }

    .codehilite pre {
      margin: 0;
    }
    .codehilite .err { background: #ff3300; color: #fff !important; } 

  table#module-list {
    font-size: 110%;
  }

    table#module-list tr td:first-child {
      padding-right: 10px;
      white-space: nowrap;
    }

    table#module-list td {
      vertical-align: top;
      padding-bottom: 8px;
    }

      table#module-list td p {
        margin: 0 0 7px 0;
      }

  .def {
    display: table;
  }

    .def p {
      display: table-cell;
      vertical-align: top;
      text-align: left;
    }

    .def p:first-child {
      white-space: nowrap;
    }

    .def p:last-child {
      width: 100%;
    }


  #index {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }
    ul#index .class_name {
      /* font-size: 110%; */
      font-weight: bold;
    }
    #index ul {
      margin: 0;
    }

  .item {
    margin: 0 0 15px 0;
  }

    .item .class {
      margin: 0 0 25px 30px;
    }

      .item .class ul.class_list {
        margin: 0 0 20px 0;
      }

    .item .name {
      background: #fafafa;
      margin: 0;
      font-weight: bold;
      padding: 5px 10px;
      border-radius: 3px;
      display: inline-block;
      min-width: 40%;
    }
      .item .name:hover {
        background: #f6f6f6;
      }

    .item .empty_desc {
      margin: 0 0 5px 0;
      padding: 0;
    }

    .item .inheritance {
      margin: 3px 0 0 30px;
    }

    .item .inherited {
      color: #666;
    }

    .item .desc {
      padding: 0 8px;
      margin: 0;
    }

      .item .desc p {
        margin: 0 0 10px 0;
      }

    .source_cont {
      margin: 0;
      padding: 0;
    }

    .source_link a {
      background: #ffc300;
      font-weight: 400;
      font-size: .75em;
      text-transform: uppercase;
      color: #fff;
      text-shadow: 1px 1px 0 #f4b700;
      
      padding: 3px 8px;
      border-radius: 2px;
      transition: background .3s ease-in-out;
    }
      .source_link a:hover {
        background: #FF7200;
        text-shadow: none;
        transition: background .3s ease-in-out;
      }

    .source {
      display: none;
      max-height: 600px;
      overflow-y: scroll;
      margin-bottom: 15px;
    }

      .source .codehilite {
        margin: 0;
      }

  .desc h1, .desc h2, .desc h3 {
    font-size: 100% !important;
  }
  .clear {
    clear: both;
  }

  @media all and (max-width: 950px) {
    #sidebar {
      width: 35%;
    }
    #content {
      width: 65%;
    }
  }
  @media all and (max-width: 650px) {
    #top {
      display: none;
    }
    #sidebar {
      float: none;
      width: auto;
    }
    #content {
      float: none;
      width: auto;
      padding: 30px;
    }

    #index ul {
      padding: 0;
      margin-bottom: 15px;
    }
    #index ul li {
      display: inline-block;
      margin-right: 30px;
    }
    #footer {
      text-align: left;
    }
    #footer p {
      display: block;
      margin: inherit;
    }
  }

  /*****************************/

  </style>


  <style type="text/css">
  
/* ==========================================================================
   EXAMPLE Media Queries for Responsive Design.
   These examples override the primary ('mobile first') styles.
   Modify as content requires.
   ========================================================================== */

@media only screen and (min-width: 35em) {
    /* Style adjustments for viewports that meet the condition */
}

@media print,
       (-o-min-device-pixel-ratio: 5/4),
       (-webkit-min-device-pixel-ratio: 1.25),
       (min-resolution: 120dpi) {
    /* Style adjustments for high resolution devices */
}

/* ==========================================================================
   Print styles.
   Inlined to avoid required HTTP connection: h5bp.com/r
   ========================================================================== */

@media print {
    * {
        background: transparent !important;
        color: #000 !important; /* Black prints faster: h5bp.com/s */
        box-shadow: none !important;
        text-shadow: none !important;
    }

    a,
    a:visited {
        text-decoration: underline;
    }

    a[href]:after {
        content: " (" attr(href) ")";
    }

    abbr[title]:after {
        content: " (" attr(title) ")";
    }

    /*
     * Don't show links for images, or javascript/internal links
     */

    .ir a:after,
    a[href^="javascript:"]:after,
    a[href^="#"]:after {
        content: "";
    }

    pre,
    blockquote {
        border: 1px solid #999;
        page-break-inside: avoid;
    }

    thead {
        display: table-header-group; /* h5bp.com/t */
    }

    tr,
    img {
        page-break-inside: avoid;
    }

    img {
        max-width: 100% !important;
    }

    @page {
        margin: 0.5cm;
    }

    p,
    h2,
    h3 {
        orphans: 3;
        widows: 3;
    }

    h2,
    h3 {
        page-break-after: avoid;
    }
}

  </style>

  <script type="text/javascript">
  function toggle(id, $link) {
    $node = document.getElementById(id);
    if (!$node)
    return;
    if (!$node.style.display || $node.style.display == 'none') {
    $node.style.display = 'block';
    $link.innerHTML = 'Hide source &nequiv;';
    } else {
    $node.style.display = 'none';
    $link.innerHTML = 'Show source &equiv;';
    }
  }
  </script>
</head>
<body>
<a href="#" id="top">Top</a>

<div id="container">
    
  
  <div id="sidebar">
    <h1>Index</h1>
    <ul id="index">
    
    <li class="set"><h3>Files</h3>
      <ul>
        <li class="mono"><a href="server.m.html">server.py</a></li>
        <li class="mono"><a href="sessionid.m.html">sessionid.py</a></li>
        <li class="mono"><a href="ajaxGoogleAPI.m.html">ajaxGoogleAPI.py</a></li>
        <li class="mono"><a href="requestsJSON.m.html">requestsJSON.py</a></li>
        <li class="mono"><a href="telegramBot.m.html">telegramBot.py</a></li>
        <li class="mono"><a href="telegramBotLivePosition.m.html">telegramBotLivePosition.py</a></li>
        <li class="mono"><a href="telegramBotOrder.m.html">telegramBotOrder</a></li>
        <li class="mono"><a href="telegramBotStart.m.html">telegramBotStart</a></li>
      </ul>
    </li>
    
    <li class="set"><h3><a href="#header-variables">Module variables</a></h3>
      
  <ul>
    <li class="mono"><a href="#server.img_dir">img_dir</a></li>
    <li class="mono"><a href="#server.json_dir">json_dir</a></li>
    <li class="mono"><a href="#server.pdf_dir">pdf_dir</a></li>
    <li class="mono"><a href="#server.server_dir">server_dir</a></li>
    <li class="mono"><a href="#server.server_root">server_root</a></li>
  </ul>

    </li>

    <li class="set"><h3><a href="#header-functions">Functions</a></h3>
      
  <ul>
    <li class="mono"><a href="#server.fileupload">fileupload</a></li>
    <li class="mono"><a href="#server.get_json_data">get_json_data</a></li>
    <li class="mono"><a href="#server.img_list">img_list</a></li>
    <li class="mono"><a href="#server.login">login</a></li>
    <li class="mono"><a href="#server.pdf_upload">pdf_upload</a></li>
    <li class="mono"><a href="#server.register">register</a></li>
    <li class="mono"><a href="#server.save_json">save_json</a></li>
  </ul>

    </li>

    <li class="set"><h3><a href="#header-classes">Classes</a></h3>
      <ul>
        <li class="mono">
        <span class="class_name"><a href="#server.MyServer">MyServer</a></span>
        
          
  <ul>
    <li class="mono"><a href="#server.MyServer.__init__">__init__</a></li>
    <li class="mono"><a href="#server.MyServer.address_string">address_string</a></li>
    <li class="mono"><a href="#server.MyServer.date_time_string">date_time_string</a></li>
    <li class="mono"><a href="#server.MyServer.delete_header">delete_header</a></li>
    <li class="mono"><a href="#server.MyServer.do_AUTHHEAD">do_AUTHHEAD</a></li>
    <li class="mono"><a href="#server.MyServer.do_GET">do_GET</a></li>
    <li class="mono"><a href="#server.MyServer.do_POST">do_POST</a></li>
    <li class="mono"><a href="#server.MyServer.end_headers">end_headers</a></li>
    <li class="mono"><a href="#server.MyServer.finish">finish</a></li>
    <li class="mono"><a href="#server.MyServer.flush_headers">flush_headers</a></li>
    <li class="mono"><a href="#server.MyServer.handle">handle</a></li>
    <li class="mono"><a href="#server.MyServer.handle_expect_100">handle_expect_100</a></li>
    <li class="mono"><a href="#server.MyServer.handle_one_request">handle_one_request</a></li>
    <li class="mono"><a href="#server.MyServer.log_date_time_string">log_date_time_string</a></li>
    <li class="mono"><a href="#server.MyServer.log_error">log_error</a></li>
    <li class="mono"><a href="#server.MyServer.log_message">log_message</a></li>
    <li class="mono"><a href="#server.MyServer.log_request">log_request</a></li>
    <li class="mono"><a href="#server.MyServer.parse_request">parse_request</a></li>
    <li class="mono"><a href="#server.MyServer.send_error">send_error</a></li>
    <li class="mono"><a href="#server.MyServer.send_header">send_header</a></li>
    <li class="mono"><a href="#server.MyServer.send_response">send_response</a></li>
    <li class="mono"><a href="#server.MyServer.send_response_only">send_response_only</a></li>
    <li class="mono"><a href="#server.MyServer.setup">setup</a></li>
    <li class="mono"><a href="#server.MyServer.version_string">version_string</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#server.ThreadingSimpleServer">ThreadingSimpleServer</a></span>
        
          
  <ul>
    <li class="mono"><a href="#server.ThreadingSimpleServer.__init__">__init__</a></li>
    <li class="mono"><a href="#server.ThreadingSimpleServer.close_request">close_request</a></li>
    <li class="mono"><a href="#server.ThreadingSimpleServer.fileno">fileno</a></li>
    <li class="mono"><a href="#server.ThreadingSimpleServer.finish_request">finish_request</a></li>
    <li class="mono"><a href="#server.ThreadingSimpleServer.get_request">get_request</a></li>
    <li class="mono"><a href="#server.ThreadingSimpleServer.handle_error">handle_error</a></li>
    <li class="mono"><a href="#server.ThreadingSimpleServer.handle_request">handle_request</a></li>
    <li class="mono"><a href="#server.ThreadingSimpleServer.handle_timeout">handle_timeout</a></li>
    <li class="mono"><a href="#server.ThreadingSimpleServer.process_request">process_request</a></li>
    <li class="mono"><a href="#server.ThreadingSimpleServer.process_request_thread">process_request_thread</a></li>
    <li class="mono"><a href="#server.ThreadingSimpleServer.serve_forever">serve_forever</a></li>
    <li class="mono"><a href="#server.ThreadingSimpleServer.server_activate">server_activate</a></li>
    <li class="mono"><a href="#server.ThreadingSimpleServer.server_bind">server_bind</a></li>
    <li class="mono"><a href="#server.ThreadingSimpleServer.server_close">server_close</a></li>
    <li class="mono"><a href="#server.ThreadingSimpleServer.service_actions">service_actions</a></li>
    <li class="mono"><a href="#server.ThreadingSimpleServer.shutdown">shutdown</a></li>
    <li class="mono"><a href="#server.ThreadingSimpleServer.shutdown_request">shutdown_request</a></li>
    <li class="mono"><a href="#server.ThreadingSimpleServer.verify_request">verify_request</a></li>
  </ul>

        </li>
      </ul>
    </li>

    </ul>
  </div>

    <article id="content">
      
  

  


  <header id="section-intro">
  <h1 class="title"><span class="name">server</span> module</h1>
  
  
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-server', this);">Show source &equiv;</a></p>
  <div id="source-server" class="source">
    <pre><code># coding=utf-8

import base64
import http.server
import json
import mimetypes
import os
import ssl
import sys
from socketserver import ThreadingMixIn

# from PythonCfg import ajaxGoogleAPI
# from PythonCfg import requestsJSON
# from PythonCfg import sessionid
import telegramBot
import ajaxGoogleAPI
import requestsJSON
import sessionid

'''
Sets all necessary paths to global variables.
'''
server_dir = os.path.dirname(os.path.abspath(__file__))
server_root = os.path.sep.join(server_dir.split(os.path.sep)[:-1])
img_dir = server_root + "/img/"
json_dir = server_root + "/json/"
pdf_dir = server_root + "/pdf/"


# commit


def save_json(request):
    """
    Saves a transmitted json to the specified file.
    !!Caution!! The file will be overwritten.
    Functions for future expansion to backup and restore 
    json-files.
    
    Function not possible to call because of security concerns.
    
    Args:
        request (dict): contains the new json string 
                        which will be written to the file
    
    Returns:
        dict:   if successful: OK
                Write not successful: Error    
    """
    global json_dir
    try:
        with open(json_dir + request["fileName"] + ".json", "w") as file:
            file.write(json.dumps(request["jsonData"]))

        response = {
            'STATUS': 'OK'
        }

    except IOError:
        response = {
            'STATUS': 'ERROR'
        }
    response = json.dumps(response)
    return response


def get_json_data(request):
    """
    Reads the whole json-string out of the specified file and sets
    ist as the response.
    
    Security Issue: Can leak all stored information because the ist no
    security check for the post-request yet.
    
    Args:
        request (dict): contains the filename of the selected json-file
    
    Returns:
        dict:   if successful: set the response to the containment of the file
    """
    try:
        global json_dir
        with open(json_dir + request['file'] + ".json") as json_data:
            d = json.load(json_data)
        response = {
            'STATUS': 'OK',
            'jsonData': d
        }
        response = json.dumps(response)
        return response
    except IOError:
        return False


def fileupload(request):
    """
    Function handles the image upload to the server.
    The file ist transmitted  via a base64 encoded string
    and on the server encodes it bag to the original format.
    
    Args:
        request (dict): contains the image string and image name
    
    Return:
        dict    successful: OK, image path
                else: error, image name
    """
    try:
        en_string = request['fileData']
        global img_dir
        f = open(img_dir + "/menu/" + request['name'], 'wb')
        de_string = en_string.split(',')[1]
        f.write(base64.b64decode(de_string))
        f.close()
        response = {
            'STATUS': 'OK',
            'imgPath': str("../img/menu/" + request['name'])
        }
    except IOError:
        response = {
            'STATUS': 'ERROR',
            'img': request['name']
        }

    response = json.dumps(response)
    return response


def pdf_upload(request):
    """
    Handles the pdf upload. The pdf ist encoded with utf8
    and on the server decoded again.
    
    Args:
        request (dict): contains the name and content of the pdf
    
    Return:
        dict    if successful: ok, path to directory
                else: Error
    """
    try:
        pdf = request.decode("utf-8")
        global pdf_dir
        f = open(pdf_dir + pdf[pdf.find("name=") + 6: pdf.find(".pdf")] + ".pdf", 'wb')  # File is created
        f.write(request)
        f.close()  # and saved
        response = {
            'STATUS': 'OK',
            'imgPath': str("../pdf/")
        }
    except IOError:
        response = {
            'STATUS': 'ERROR',
            'img': ''
        }

    response = json.dumps(response)
    return response


def img_list():
    """
    Lists all the pictures stored in the folder menu
    on the server.
    
    Args:
    
    Return:
        dict    List of the Pictures as a json-string
    """
    global img_dir
    img_list_data = os.listdir(server_root + "/img/menu/")
    return json.dumps(img_list_data)


def login(request):
    """
    Handles the login of the server and creates a session id.
    
    Args:
        request (dict)  contains the username/email-address and password
                        in this structure:
                        {
                            "request" : "login",
                            "username" : "",
                            "password" : ""
                        }
    
    Return:
        if successful: OK, SessionId
        else: False
    """
    try:
        global json_dir
        with open(json_dir + "customers.json") as json_data:
            customers = json.load(json_data)

        response = {
            'STATUS': 'ERROR'
        }
        for customer in customers:
            if (request["value"]["username"] == customer["email"]
                    and request["value"]["password"] == customer["password"]):
                response = {
                    'STATUS': 'OK',
                    'sid': sessionid.create_session_id()
                }
        response = json.dumps(response)
        return response

    except IOError:
        return False


def register(request):
    """
    Handles a register request to the server.
    Function tests if email address is already registered.
    If not the new account information are stored.
    
    Args:
        request (dict): Contains all information of the
                        new customer 
                        in this structure:
                        {
                            "id": ,
                            "firstname": "",
                            "lastname": "",
                            "email": "",
                            "password": "",
                            "contact": {
                                "name": "firstname" + " " + "lastname",
                                "postcode": "",
                                "street": "",
                                "city": "",
                                "nr": "",
                                "phone": "",
                                "chat_id": ""
                            }
                        }
    
    Return:
        if email exist: Error
        if successful stored: Ok
        else: Error
    """
    global json_dir

    try:
        with open(json_dir + "customers.json", "r+") as file:
            contacts = json.loads(file.read())
            number = 0
            value = request["value"]
            found = False

            for contact in contacts:
                if value["email"] == contact["email"]:
                    response = {
                        'STATUS': 'ERROR'
                    }
                    found = True
                    break

                if number < int(contact["id"]):
                    number = int(contact["id"])

            if not found:
                data = {
                    "id": (number + 1),
                    "firstname": value["firstname"],
                    "lastname": value["lastname"],
                    "email": value["email"],
                    "password": value["password"],
                    "contact": {
                        "name": value["firstname"] + " " + value["lastname"],
                        "postcode": value["postcode"],
                        "street": value["street"],
                        "city": value["city"],
                        "nr": value["streetNr"],
                        "phone": value["phone"],
                        "chat_id": value["chat_id"]
                    }
                }
                contacts.append(data)
                file.seek(0)
                file.truncate()
                file.write(json.dumps(contacts))
                response = {
                    'STATUS': 'OK'
                }

        file.close()

    except IOError:
        response = {
            'STATUS': 'ERROR'
        }
    response = json.dumps(response)
    return response


class MyServer(http.server.BaseHTTPRequestHandler):
    """
    Server class, handles all the requests made by clients.
    
    Args:
        http.server.BaseHTTPRequestHandler (handler)
        
    Return:
        to the client:
            different web pages via "get"
            different actions via "post"
            error messages,...
    """
    key = "Basic:test"  # User & Password for admin Page
    key = base64.b64encode(bytes(key, "UTF8"))

    def do_AUTHHEAD(self):
        """
        Sends a error message by a wrong authentication.
        
        Args:
            self (class): contains the reference 
                          information to the own class
        
        Return:
            Error 401
        """
        print("send header")
        self.send_response(401)
        self.send_header('WWW-Authenticate', 'Basic realm=\"test\"')
        self.send_header('Content-type', 'text/html')
        self.end_headers()

    def do_GET(self):
        """
        Handles the "GET" requests to the server.
        And a basic authentication for the admin page.
        
        Args:
            self (class): contains the reference 
                          information to the own class
        
        Return:
            different web pages to the client
        """
        global server_root

        if self.path == "/":
            self.path = "/index.html"

        '''
        appends to a file ".html" if no file extension is given
        '''
        if (not (self.path.endswith(".html") or self.path.endswith(".css") or self.path.endswith(
                ".json") or self.path.endswith(".js") or self.path.endswith(".gif") or self.path.endswith(".png")
                 or self.path.endswith(".jpg") or self.path.endswith(".ico"))):
            self.path += ".html"

        mime, encoding = mimetypes.guess_type(self.path)
        if "admin" in self.path:
            if ('Basic ' + MyServer.key.decode("utf-8") != self.headers['Authorization'] or
                    self.headers['Authorization'] is None):
                self.do_AUTHHEAD()
                self.wfile.write(bytes(open(server_root + "/401.html").read(), "UTF8"))
                pass
            elif self.headers['Authorization'] in 'Basic ' + MyServer.key.decode("utf-8"):
                print("passed")
                self.__set_header(mime)
                self.__getfile(self.path, encoding, mime)
                pass
        else:
            self.__set_header(mime)
            self.__getfile(self.path, encoding, mime)
            pass

    def __getfile(self, path, encoding, mime):
        """
        Loads requested files and sends it to the customer.
        
        Args:
            self (class)  : contains the reference 
                            information to the own class
            path (str)    : contains the requested path
            encoding (str): if given: contains the encoding
            mime (str)    : holds information of the mime-type
        """
        global server_root
        try:
            if encoding is None:
                f = open(server_root + path, 'rb')  # open requested file
                self.wfile.write(bytes(f.read()))
            else:
                f = open(server_root + path)
                self.wfile.write(bytes(f.read(), "UTF8"))
                f.close()
        except IOError:
            self.wfile.write(bytes(open(server_root + "/404.html").read(), "UTF8"))

    def __set_header(self, mime):
        """
        Sets the header for a response to the client
        if the request was successful.
        
        Args:
            self (class)  : contains the reference 
                            information to the own class
            mime (str)    : holds information of the mime-type
        
        Return:
            Code 200, mime type
        """
        self.send_response(200)
        self.send_header('Content-type', mime)
        self.end_headers()

    def delete_header(self):
        self.send_response(200)
        self.send_header("Authorization", " ")
        self.end_headers()
        return "OK"

    @staticmethod
    def __convertHTML(path, encoding='UTF8'):
        """
        Converts a html file to bytes.
        
        Args:
            self (class)  : contains the reference 
                            information to the own class
            path (str)    : contains the requested path
            encoding (str): contains the encoding, 
                            if not given sets it tp "UTF")
        
        Return:
            encoded file content
        """
        return bytes(open(path, 'r').read(), encoding)

    def do_POST(self):
        """
        Handles the "POST" requests to the server
        based on the information stored in the "request" 
        segment of the request.
        
        Args:
            self (class): contains the reference 
                          information to the own class
        
        Return:
            different information to the client
        """
        self.send_response(200)
        self.send_header('Content-type', 'text/html')
        self.send_header('Access-Control-Allow-Origin', '*  ')
        self.end_headers()
        request = self.rfile.read(int(self.headers['Content-Length']))
        try:
            data = json.loads(request)
            try:
                if data['request'] == 'fileUpload':
                    response = fileupload(data)
                    self.wfile.write(bytes(response, 'UTF8'))
                if data['request'] == 'images':
                    response = img_list()
                    self.wfile.write(bytes(response, 'UTF8'))
                if data['request'] == 'jsonRequest':
                    response = get_json_data(data)
                    self.wfile.write(bytes(response, 'UTF8'))
                if data['request'] == 'ajaxGoogleAPI':
                    response = ajaxGoogleAPI.calc_distance(data)
                    self.wfile.write(bytes(response, 'UTF8'))
                if data['request'] == 'save_json':
                    response = save_json(data)
                    self.wfile.write(bytes(response, 'UTF8'))
                if data['request'] == 'deleteHeader':
                    response = MyServer.delete_header(self)
                    self.wfile.write(bytes(response, "UTF8"))
                if data['request'] == 'newOrder':
                    response = requestsJSON.append_order(json_dir, data)
                    self.wfile.write(bytes(response, "UTF8"))
                if data['request'] == 'get_order_by_id':
                    response = requestsJSON.get_order_by_id(json_dir, data)
                    self.wfile.write(bytes(response, 'UTF8'))
                if data['request'] == 'login':
                    response = login(data)
                    self.wfile.write(bytes(response, 'UTF8'))
                if data['request'] == 'logout':
                    response = sessionid.logout(data['value']['sid'])
                    self.wfile.write(bytes(response, 'UTF8'))
                if data['request'] == 'register':
                    response = register(data)
                    self.wfile.write(bytes(response, 'UTF8'))
                if data['request'] == 'checkSID':
                    response = sessionid.check_session_id(data['value']['sid'])
                    self.wfile.write(bytes(response, 'UTF8'))
                if data['request'] == 'getUserData':
                    response = requestsJSON.get_customer_data_by_mail(json_dir, data['value']['email'])
                    self.wfile.write(bytes(response, 'UTF8'))
                if data['request'] == 'updateData':
                    response = requestsJSON.update_user_data(json_dir, data['value'])
                    self.wfile.write(bytes(response, 'UTF8'))
                if data['request'] == 'delete_user':
                    response = requestsJSON.delete_user(json_dir, data['value'])
                    self.wfile.write(bytes(response, 'UTF8'))
                if data['request'] == 'get_order_by_mail':
                    print("order by email request")
                    response = requestsJSON.get_order_by_mail(json_dir, data['value'])
                    self.wfile.write(bytes(response, 'UTF8'))
            except IOError:
                self.send_error(404, "Something went wrong")
        except json.decoder.JSONDecodeError:
            pdf_upload(request)


class ThreadingSimpleServer(ThreadingMixIn, http.server.HTTPServer):
    """
    Handles the multithreading of the web server.
    
    Args:
        ThreadingMixIn (tuple): information about the ip and port
        http.server.HTTPServer (handler)
    
    return:
    """
    pass


if __name__ == '__main__':
    '''
    This sets the listening port, default port 8080
    '''
    if sys.argv[1:]:
        PORT = int(sys.argv[1])
    else:
        PORT = 8080

    server = ThreadingSimpleServer(('localhost', PORT), MyServer)

    '''
    Changes the usual socket from the handler to a encrypted socket.
    '''
    server.socket = ssl.wrap_socket(server.socket,
                                    server_side=True,
                                    certfile=server_dir + '/server_org.pem',
                                    ssl_version=ssl.PROTOCOL_TLSv1
                                    )

    print("running on https://localhost:" + str(PORT))
    try:
        while 1:
            sys.stdout.flush()
            server.handle_request()

    except KeyboardInterrupt:
        print("Shutting down server per users request.")
</code></pre>
  </div>

  </header>

  <section id="section-items">
    <h2 class="section-title" id="header-variables">Module variables</h2>
      <div class="item">
      <p id="server.img_dir" class="name">var <span class="ident">img_dir</span></p>
      
  
  <div class="source_cont">
</div>

      </div>
      <div class="item">
      <p id="server.json_dir" class="name">var <span class="ident">json_dir</span></p>
      
  
  <div class="source_cont">
</div>

      </div>
      <div class="item">
      <p id="server.pdf_dir" class="name">var <span class="ident">pdf_dir</span></p>
      
  
  <div class="source_cont">
</div>

      </div>
      <div class="item">
      <p id="server.server_dir" class="name">var <span class="ident">server_dir</span></p>
      
  
  <div class="source_cont">
</div>

      </div>
      <div class="item">
      <p id="server.server_root" class="name">var <span class="ident">server_root</span></p>
      
  
  <div class="source_cont">
</div>

      </div>

    <h2 class="section-title" id="header-functions">Functions</h2>
      
  <div class="item">
    <div class="name def" id="server.fileupload">
    <p>def <span class="ident">fileupload</span>(</p><p>request)</p>
    </div>
    

    
  
    <div class="desc"><p>Function handles the image upload to the server.
The file ist transmitted  via a base64 encoded string
and on the server encodes it bag to the original format.</p>
<p>Args:
    request (dict): contains the image string and image name</p>
<p>Return:
    dict    successful: OK, image path
            else: error, image name</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-server.fileupload', this);">Show source &equiv;</a></p>
  <div id="source-server.fileupload" class="source">
    <pre><code>def fileupload(request):
    """
    Function handles the image upload to the server.
    The file ist transmitted  via a base64 encoded string
    and on the server encodes it bag to the original format.
    
    Args:
        request (dict): contains the image string and image name
    
    Return:
        dict    successful: OK, image path
                else: error, image name
    """
    try:
        en_string = request['fileData']
        global img_dir
        f = open(img_dir + "/menu/" + request['name'], 'wb')
        de_string = en_string.split(',')[1]
        f.write(base64.b64decode(de_string))
        f.close()
        response = {
            'STATUS': 'OK',
            'imgPath': str("../img/menu/" + request['name'])
        }
    except IOError:
        response = {
            'STATUS': 'ERROR',
            'img': request['name']
        }

    response = json.dumps(response)
    return response
</code></pre>
  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="server.get_json_data">
    <p>def <span class="ident">get_json_data</span>(</p><p>request)</p>
    </div>
    

    
  
    <div class="desc"><p>Reads the whole json-string out of the specified file and sets
ist as the response.</p>
<p>Security Issue: Can leak all stored information because the ist no
security check for the post-request yet.</p>
<p>Args:
    request (dict): contains the filename of the selected json-file</p>
<p>Returns:
    dict:   if successful: set the response to the containment of the file</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-server.get_json_data', this);">Show source &equiv;</a></p>
  <div id="source-server.get_json_data" class="source">
    <pre><code>def get_json_data(request):
    """
    Reads the whole json-string out of the specified file and sets
    ist as the response.
    
    Security Issue: Can leak all stored information because the ist no
    security check for the post-request yet.
    
    Args:
        request (dict): contains the filename of the selected json-file
    
    Returns:
        dict:   if successful: set the response to the containment of the file
    """
    try:
        global json_dir
        with open(json_dir + request['file'] + ".json") as json_data:
            d = json.load(json_data)
        response = {
            'STATUS': 'OK',
            'jsonData': d
        }
        response = json.dumps(response)
        return response
    except IOError:
        return False
</code></pre>
  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="server.img_list">
    <p>def <span class="ident">img_list</span>(</p><p>)</p>
    </div>
    

    
  
    <div class="desc"><p>Lists all the pictures stored in the folder menu
on the server.</p>
<p>Args:</p>
<p>Return:
    dict    List of the Pictures as a json-string</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-server.img_list', this);">Show source &equiv;</a></p>
  <div id="source-server.img_list" class="source">
    <pre><code>def img_list():
    """
    Lists all the pictures stored in the folder menu
    on the server.
    
    Args:
    
    Return:
        dict    List of the Pictures as a json-string
    """
    global img_dir
    img_list_data = os.listdir(server_root + "/img/menu/")
    return json.dumps(img_list_data)
</code></pre>
  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="server.login">
    <p>def <span class="ident">login</span>(</p><p>request)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles the login of the server and creates a session id.</p>
<p>Args:
    request (dict)  contains the username/email-address and password
                    in this structure:
                    {
                        "request" : "login",
                        "username" : "",
                        "password" : ""
                    }</p>
<p>Return:
    if successful: OK, SessionId
    else: False</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-server.login', this);">Show source &equiv;</a></p>
  <div id="source-server.login" class="source">
    <pre><code>def login(request):
    """
    Handles the login of the server and creates a session id.
    
    Args:
        request (dict)  contains the username/email-address and password
                        in this structure:
                        {
                            "request" : "login",
                            "username" : "",
                            "password" : ""
                        }
    
    Return:
        if successful: OK, SessionId
        else: False
    """
    try:
        global json_dir
        with open(json_dir + "customers.json") as json_data:
            customers = json.load(json_data)

        response = {
            'STATUS': 'ERROR'
        }
        for customer in customers:
            if (request["value"]["username"] == customer["email"]
                    and request["value"]["password"] == customer["password"]):
                response = {
                    'STATUS': 'OK',
                    'sid': sessionid.create_session_id()
                }
        response = json.dumps(response)
        return response

    except IOError:
        return False
</code></pre>
  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="server.pdf_upload">
    <p>def <span class="ident">pdf_upload</span>(</p><p>request)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles the pdf upload. The pdf ist encoded with utf8
and on the server decoded again.</p>
<p>Args:
    request (dict): contains the name and content of the pdf</p>
<p>Return:
    dict    if successful: ok, path to directory
            else: Error</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-server.pdf_upload', this);">Show source &equiv;</a></p>
  <div id="source-server.pdf_upload" class="source">
    <pre><code>def pdf_upload(request):
    """
    Handles the pdf upload. The pdf ist encoded with utf8
    and on the server decoded again.
    
    Args:
        request (dict): contains the name and content of the pdf
    
    Return:
        dict    if successful: ok, path to directory
                else: Error
    """
    try:
        pdf = request.decode("utf-8")
        global pdf_dir
        f = open(pdf_dir + pdf[pdf.find("name=") + 6: pdf.find(".pdf")] + ".pdf", 'wb')  # File is created
        f.write(request)
        f.close()  # and saved
        response = {
            'STATUS': 'OK',
            'imgPath': str("../pdf/")
        }
    except IOError:
        response = {
            'STATUS': 'ERROR',
            'img': ''
        }

    response = json.dumps(response)
    return response
</code></pre>
  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="server.register">
    <p>def <span class="ident">register</span>(</p><p>request)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles a register request to the server.
Function tests if email address is already registered.
If not the new account information are stored.</p>
<p>Args:
    request (dict): Contains all information of the
                    new customer 
                    in this structure:
                    {
                        "id": ,
                        "firstname": "",
                        "lastname": "",
                        "email": "",
                        "password": "",
                        "contact": {
                            "name": "firstname" + " " + "lastname",
                            "postcode": "",
                            "street": "",
                            "city": "",
                            "nr": "",
                            "phone": "",
                            "chat_id": ""
                        }
                    }</p>
<p>Return:
    if email exist: Error
    if successful stored: Ok
    else: Error</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-server.register', this);">Show source &equiv;</a></p>
  <div id="source-server.register" class="source">
    <pre><code>def register(request):
    """
    Handles a register request to the server.
    Function tests if email address is already registered.
    If not the new account information are stored.
    
    Args:
        request (dict): Contains all information of the
                        new customer 
                        in this structure:
                        {
                            "id": ,
                            "firstname": "",
                            "lastname": "",
                            "email": "",
                            "password": "",
                            "contact": {
                                "name": "firstname" + " " + "lastname",
                                "postcode": "",
                                "street": "",
                                "city": "",
                                "nr": "",
                                "phone": "",
                                "chat_id": ""
                            }
                        }
    
    Return:
        if email exist: Error
        if successful stored: Ok
        else: Error
    """
    global json_dir

    try:
        with open(json_dir + "customers.json", "r+") as file:
            contacts = json.loads(file.read())
            number = 0
            value = request["value"]
            found = False

            for contact in contacts:
                if value["email"] == contact["email"]:
                    response = {
                        'STATUS': 'ERROR'
                    }
                    found = True
                    break

                if number < int(contact["id"]):
                    number = int(contact["id"])

            if not found:
                data = {
                    "id": (number + 1),
                    "firstname": value["firstname"],
                    "lastname": value["lastname"],
                    "email": value["email"],
                    "password": value["password"],
                    "contact": {
                        "name": value["firstname"] + " " + value["lastname"],
                        "postcode": value["postcode"],
                        "street": value["street"],
                        "city": value["city"],
                        "nr": value["streetNr"],
                        "phone": value["phone"],
                        "chat_id": value["chat_id"]
                    }
                }
                contacts.append(data)
                file.seek(0)
                file.truncate()
                file.write(json.dumps(contacts))
                response = {
                    'STATUS': 'OK'
                }

        file.close()

    except IOError:
        response = {
            'STATUS': 'ERROR'
        }
    response = json.dumps(response)
    return response
</code></pre>
  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="server.save_json">
    <p>def <span class="ident">save_json</span>(</p><p>request)</p>
    </div>
    

    
  
    <div class="desc"><p>Saves a transmitted json to the specified file.
!!Caution!! The file will be overwritten.
Functions for future expansion to backup and restore 
json-files.</p>
<p>Function not possible to call because of security concerns.</p>
<p>Args:
    request (dict): contains the new json string 
                    which will be written to the file</p>
<p>Returns:
    dict:   if successful: OK
            Write not successful: Error</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-server.save_json', this);">Show source &equiv;</a></p>
  <div id="source-server.save_json" class="source">
    <pre><code>def save_json(request):
    """
    Saves a transmitted json to the specified file.
    !!Caution!! The file will be overwritten.
    Functions for future expansion to backup and restore 
    json-files.
    
    Function not possible to call because of security concerns.
    
    Args:
        request (dict): contains the new json string 
                        which will be written to the file
    
    Returns:
        dict:   if successful: OK
                Write not successful: Error    
    """
    global json_dir
    try:
        with open(json_dir + request["fileName"] + ".json", "w") as file:
            file.write(json.dumps(request["jsonData"]))

        response = {
            'STATUS': 'OK'
        }

    except IOError:
        response = {
            'STATUS': 'ERROR'
        }
    response = json.dumps(response)
    return response
</code></pre>
  </div>
</div>

  </div>
  

    <h2 class="section-title" id="header-classes">Classes</h2>
      
      <div class="item">
      <p id="server.MyServer" class="name">class <span class="ident">MyServer</span></p>
      
  
    <div class="desc"><p>Server class, handles all the requests made by clients.</p>
<p>Args:
    http.server.BaseHTTPRequestHandler (handler)</p>
<p>Return:
    to the client:
        different web pages via "get"
        different actions via "post"
        error messages,...</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-server.MyServer', this);">Show source &equiv;</a></p>
  <div id="source-server.MyServer" class="source">
    <pre><code>class MyServer(http.server.BaseHTTPRequestHandler):
    """
    Server class, handles all the requests made by clients.
    
    Args:
        http.server.BaseHTTPRequestHandler (handler)
        
    Return:
        to the client:
            different web pages via "get"
            different actions via "post"
            error messages,...
    """
    key = "Basic:test"  # User & Password for admin Page
    key = base64.b64encode(bytes(key, "UTF8"))

    def do_AUTHHEAD(self):
        """
        Sends a error message by a wrong authentication.
        
        Args:
            self (class): contains the reference 
                          information to the own class
        
        Return:
            Error 401
        """
        print("send header")
        self.send_response(401)
        self.send_header('WWW-Authenticate', 'Basic realm=\"test\"')
        self.send_header('Content-type', 'text/html')
        self.end_headers()

    def do_GET(self):
        """
        Handles the "GET" requests to the server.
        And a basic authentication for the admin page.
        
        Args:
            self (class): contains the reference 
                          information to the own class
        
        Return:
            different web pages to the client
        """
        global server_root

        if self.path == "/":
            self.path = "/index.html"

        '''
        appends to a file ".html" if no file extension is given
        '''
        if (not (self.path.endswith(".html") or self.path.endswith(".css") or self.path.endswith(
                ".json") or self.path.endswith(".js") or self.path.endswith(".gif") or self.path.endswith(".png")
                 or self.path.endswith(".jpg") or self.path.endswith(".ico"))):
            self.path += ".html"

        mime, encoding = mimetypes.guess_type(self.path)
        if "admin" in self.path:
            if ('Basic ' + MyServer.key.decode("utf-8") != self.headers['Authorization'] or
                    self.headers['Authorization'] is None):
                self.do_AUTHHEAD()
                self.wfile.write(bytes(open(server_root + "/401.html").read(), "UTF8"))
                pass
            elif self.headers['Authorization'] in 'Basic ' + MyServer.key.decode("utf-8"):
                print("passed")
                self.__set_header(mime)
                self.__getfile(self.path, encoding, mime)
                pass
        else:
            self.__set_header(mime)
            self.__getfile(self.path, encoding, mime)
            pass

    def __getfile(self, path, encoding, mime):
        """
        Loads requested files and sends it to the customer.
        
        Args:
            self (class)  : contains the reference 
                            information to the own class
            path (str)    : contains the requested path
            encoding (str): if given: contains the encoding
            mime (str)    : holds information of the mime-type
        """
        global server_root
        try:
            if encoding is None:
                f = open(server_root + path, 'rb')  # open requested file
                self.wfile.write(bytes(f.read()))
            else:
                f = open(server_root + path)
                self.wfile.write(bytes(f.read(), "UTF8"))
                f.close()
        except IOError:
            self.wfile.write(bytes(open(server_root + "/404.html").read(), "UTF8"))

    def __set_header(self, mime):
        """
        Sets the header for a response to the client
        if the request was successful.
        
        Args:
            self (class)  : contains the reference 
                            information to the own class
            mime (str)    : holds information of the mime-type
        
        Return:
            Code 200, mime type
        """
        self.send_response(200)
        self.send_header('Content-type', mime)
        self.end_headers()

    def delete_header(self):
        self.send_response(200)
        self.send_header("Authorization", " ")
        self.end_headers()
        return "OK"

    @staticmethod
    def __convertHTML(path, encoding='UTF8'):
        """
        Converts a html file to bytes.
        
        Args:
            self (class)  : contains the reference 
                            information to the own class
            path (str)    : contains the requested path
            encoding (str): contains the encoding, 
                            if not given sets it tp "UTF")
        
        Return:
            encoded file content
        """
        return bytes(open(path, 'r').read(), encoding)

    def do_POST(self):
        """
        Handles the "POST" requests to the server
        based on the information stored in the "request" 
        segment of the request.
        
        Args:
            self (class): contains the reference 
                          information to the own class
        
        Return:
            different information to the client
        """
        self.send_response(200)
        self.send_header('Content-type', 'text/html')
        self.send_header('Access-Control-Allow-Origin', '*  ')
        self.end_headers()
        request = self.rfile.read(int(self.headers['Content-Length']))
        try:
            data = json.loads(request)
            try:
                if data['request'] == 'fileUpload':
                    response = fileupload(data)
                    self.wfile.write(bytes(response, 'UTF8'))
                if data['request'] == 'images':
                    response = img_list()
                    self.wfile.write(bytes(response, 'UTF8'))
                if data['request'] == 'jsonRequest':
                    response = get_json_data(data)
                    self.wfile.write(bytes(response, 'UTF8'))
                if data['request'] == 'ajaxGoogleAPI':
                    response = ajaxGoogleAPI.calc_distance(data)
                    self.wfile.write(bytes(response, 'UTF8'))
                if data['request'] == 'save_json':
                    response = save_json(data)
                    self.wfile.write(bytes(response, 'UTF8'))
                if data['request'] == 'deleteHeader':
                    response = MyServer.delete_header(self)
                    self.wfile.write(bytes(response, "UTF8"))
                if data['request'] == 'newOrder':
                    response = requestsJSON.append_order(json_dir, data)
                    self.wfile.write(bytes(response, "UTF8"))
                if data['request'] == 'get_order_by_id':
                    response = requestsJSON.get_order_by_id(json_dir, data)
                    self.wfile.write(bytes(response, 'UTF8'))
                if data['request'] == 'login':
                    response = login(data)
                    self.wfile.write(bytes(response, 'UTF8'))
                if data['request'] == 'logout':
                    response = sessionid.logout(data['value']['sid'])
                    self.wfile.write(bytes(response, 'UTF8'))
                if data['request'] == 'register':
                    response = register(data)
                    self.wfile.write(bytes(response, 'UTF8'))
                if data['request'] == 'checkSID':
                    response = sessionid.check_session_id(data['value']['sid'])
                    self.wfile.write(bytes(response, 'UTF8'))
                if data['request'] == 'getUserData':
                    response = requestsJSON.get_customer_data_by_mail(json_dir, data['value']['email'])
                    self.wfile.write(bytes(response, 'UTF8'))
                if data['request'] == 'updateData':
                    response = requestsJSON.update_user_data(json_dir, data['value'])
                    self.wfile.write(bytes(response, 'UTF8'))
                if data['request'] == 'delete_user':
                    response = requestsJSON.delete_user(json_dir, data['value'])
                    self.wfile.write(bytes(response, 'UTF8'))
                if data['request'] == 'get_order_by_mail':
                    print("order by email request")
                    response = requestsJSON.get_order_by_mail(json_dir, data['value'])
                    self.wfile.write(bytes(response, 'UTF8'))
            except IOError:
                self.send_error(404, "Something went wrong")
        except json.decoder.JSONDecodeError:
            pdf_upload(request)
</code></pre>
  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#server.MyServer">MyServer</a></li>
          <li>http.server.BaseHTTPRequestHandler</li>
          <li>socketserver.StreamRequestHandler</li>
          <li>socketserver.BaseRequestHandler</li>
          <li>builtins.object</li>
          </ul>
          <h3>Class variables</h3>
            <div class="item">
            <p id="server.MyServer.MessageClass" class="name">var <span class="ident">MessageClass</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="server.MyServer.default_request_version" class="name">var <span class="ident">default_request_version</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="server.MyServer.disable_nagle_algorithm" class="name">var <span class="ident">disable_nagle_algorithm</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="server.MyServer.error_content_type" class="name">var <span class="ident">error_content_type</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="server.MyServer.error_message_format" class="name">var <span class="ident">error_message_format</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="server.MyServer.key" class="name">var <span class="ident">key</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="server.MyServer.monthname" class="name">var <span class="ident">monthname</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="server.MyServer.protocol_version" class="name">var <span class="ident">protocol_version</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="server.MyServer.rbufsize" class="name">var <span class="ident">rbufsize</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="server.MyServer.responses" class="name">var <span class="ident">responses</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="server.MyServer.server_version" class="name">var <span class="ident">server_version</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="server.MyServer.sys_version" class="name">var <span class="ident">sys_version</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="server.MyServer.timeout" class="name">var <span class="ident">timeout</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="server.MyServer.wbufsize" class="name">var <span class="ident">wbufsize</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="server.MyServer.weekdayname" class="name">var <span class="ident">weekdayname</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="server.MyServer.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, request, client_address, server)</p>
    </div>
    

    
  
    <div class="desc"><p>Initialize self.  See help(type(self)) for accurate signature.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-server.MyServer.__init__', this);">Show source &equiv;</a></p>
  <div id="source-server.MyServer.__init__" class="source">
    <pre><code>def __init__(self, request, client_address, server):
    self.request = request
    self.client_address = client_address
    self.server = server
    self.setup()
    try:
        self.handle()
    finally:
        self.finish()
</code></pre>
  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="server.MyServer.address_string">
    <p>def <span class="ident">address_string</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Return the client address.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-server.MyServer.address_string', this);">Show source &equiv;</a></p>
  <div id="source-server.MyServer.address_string" class="source">
    <pre><code>def address_string(self):
    """Return the client address."""
    return self.client_address[0]
</code></pre>
  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="server.MyServer.date_time_string">
    <p>def <span class="ident">date_time_string</span>(</p><p>self, timestamp=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Return the current date and time formatted for a message header.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-server.MyServer.date_time_string', this);">Show source &equiv;</a></p>
  <div id="source-server.MyServer.date_time_string" class="source">
    <pre><code>def date_time_string(self, timestamp=None):
    """Return the current date and time formatted for a message header."""
    if timestamp is None:
        timestamp = time.time()
    year, month, day, hh, mm, ss, wd, y, z = time.gmtime(timestamp)
    s = "%s, %02d %3s %4d %02d:%02d:%02d GMT" % (
            self.weekdayname[wd],
            day, self.monthname[month], year,
            hh, mm, ss)
    return s
</code></pre>
  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="server.MyServer.delete_header">
    <p>def <span class="ident">delete_header</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-server.MyServer.delete_header', this);">Show source &equiv;</a></p>
  <div id="source-server.MyServer.delete_header" class="source">
    <pre><code>def delete_header(self):
    self.send_response(200)
    self.send_header("Authorization", " ")
    self.end_headers()
    return "OK"
</code></pre>
  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="server.MyServer.do_AUTHHEAD">
    <p>def <span class="ident">do_AUTHHEAD</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Sends a error message by a wrong authentication.</p>
<p>Args:
    self (class): contains the reference 
                  information to the own class</p>
<p>Return:
    Error 401</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-server.MyServer.do_AUTHHEAD', this);">Show source &equiv;</a></p>
  <div id="source-server.MyServer.do_AUTHHEAD" class="source">
    <pre><code>def do_AUTHHEAD(self):
    """
    Sends a error message by a wrong authentication.
    
    Args:
        self (class): contains the reference 
                      information to the own class
    
    Return:
        Error 401
    """
    print("send header")
    self.send_response(401)
    self.send_header('WWW-Authenticate', 'Basic realm=\"test\"')
    self.send_header('Content-type', 'text/html')
    self.end_headers()
</code></pre>
  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="server.MyServer.do_GET">
    <p>def <span class="ident">do_GET</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles the "GET" requests to the server.
And a basic authentication for the admin page.</p>
<p>Args:
    self (class): contains the reference 
                  information to the own class</p>
<p>Return:
    different web pages to the client</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-server.MyServer.do_GET', this);">Show source &equiv;</a></p>
  <div id="source-server.MyServer.do_GET" class="source">
    <pre><code>def do_GET(self):
    """
    Handles the "GET" requests to the server.
    And a basic authentication for the admin page.
    
    Args:
        self (class): contains the reference 
                      information to the own class
    
    Return:
        different web pages to the client
    """
    global server_root
    if self.path == "/":
        self.path = "/index.html"
    '''
    appends to a file ".html" if no file extension is given
    '''
    if (not (self.path.endswith(".html") or self.path.endswith(".css") or self.path.endswith(
            ".json") or self.path.endswith(".js") or self.path.endswith(".gif") or self.path.endswith(".png")
             or self.path.endswith(".jpg") or self.path.endswith(".ico"))):
        self.path += ".html"
    mime, encoding = mimetypes.guess_type(self.path)
    if "admin" in self.path:
        if ('Basic ' + MyServer.key.decode("utf-8") != self.headers['Authorization'] or
                self.headers['Authorization'] is None):
            self.do_AUTHHEAD()
            self.wfile.write(bytes(open(server_root + "/401.html").read(), "UTF8"))
            pass
        elif self.headers['Authorization'] in 'Basic ' + MyServer.key.decode("utf-8"):
            print("passed")
            self.__set_header(mime)
            self.__getfile(self.path, encoding, mime)
            pass
    else:
        self.__set_header(mime)
        self.__getfile(self.path, encoding, mime)
        pass
</code></pre>
  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="server.MyServer.do_POST">
    <p>def <span class="ident">do_POST</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles the "POST" requests to the server
based on the information stored in the "request" 
segment of the request.</p>
<p>Args:
    self (class): contains the reference 
                  information to the own class</p>
<p>Return:
    different information to the client</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-server.MyServer.do_POST', this);">Show source &equiv;</a></p>
  <div id="source-server.MyServer.do_POST" class="source">
    <pre><code>def do_POST(self):
    """
    Handles the "POST" requests to the server
    based on the information stored in the "request" 
    segment of the request.
    
    Args:
        self (class): contains the reference 
                      information to the own class
    
    Return:
        different information to the client
    """
    self.send_response(200)
    self.send_header('Content-type', 'text/html')
    self.send_header('Access-Control-Allow-Origin', '*  ')
    self.end_headers()
    request = self.rfile.read(int(self.headers['Content-Length']))
    try:
        data = json.loads(request)
        try:
            if data['request'] == 'fileUpload':
                response = fileupload(data)
                self.wfile.write(bytes(response, 'UTF8'))
            if data['request'] == 'images':
                response = img_list()
                self.wfile.write(bytes(response, 'UTF8'))
            if data['request'] == 'jsonRequest':
                response = get_json_data(data)
                self.wfile.write(bytes(response, 'UTF8'))
            if data['request'] == 'ajaxGoogleAPI':
                response = ajaxGoogleAPI.calc_distance(data)
                self.wfile.write(bytes(response, 'UTF8'))
            if data['request'] == 'save_json':
                response = save_json(data)
                self.wfile.write(bytes(response, 'UTF8'))
            if data['request'] == 'deleteHeader':
                response = MyServer.delete_header(self)
                self.wfile.write(bytes(response, "UTF8"))
            if data['request'] == 'newOrder':
                response = requestsJSON.append_order(json_dir, data)
                self.wfile.write(bytes(response, "UTF8"))
            if data['request'] == 'get_order_by_id':
                response = requestsJSON.get_order_by_id(json_dir, data)
                self.wfile.write(bytes(response, 'UTF8'))
            if data['request'] == 'login':
                response = login(data)
                self.wfile.write(bytes(response, 'UTF8'))
            if data['request'] == 'logout':
                response = sessionid.logout(data['value']['sid'])
                self.wfile.write(bytes(response, 'UTF8'))
            if data['request'] == 'register':
                response = register(data)
                self.wfile.write(bytes(response, 'UTF8'))
            if data['request'] == 'checkSID':
                response = sessionid.check_session_id(data['value']['sid'])
                self.wfile.write(bytes(response, 'UTF8'))
            if data['request'] == 'getUserData':
                response = requestsJSON.get_customer_data_by_mail(json_dir, data['value']['email'])
                self.wfile.write(bytes(response, 'UTF8'))
            if data['request'] == 'updateData':
                response = requestsJSON.update_user_data(json_dir, data['value'])
                self.wfile.write(bytes(response, 'UTF8'))
            if data['request'] == 'delete_user':
                response = requestsJSON.delete_user(json_dir, data['value'])
                self.wfile.write(bytes(response, 'UTF8'))
            if data['request'] == 'get_order_by_mail':
                print("order by email request")
                response = requestsJSON.get_order_by_mail(json_dir, data['value'])
                self.wfile.write(bytes(response, 'UTF8'))
        except IOError:
            self.send_error(404, "Something went wrong")
    except json.decoder.JSONDecodeError:
        pdf_upload(request)
</code></pre>
  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="server.MyServer.end_headers">
    <p>def <span class="ident">end_headers</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Send the blank line ending the MIME headers.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-server.MyServer.end_headers', this);">Show source &equiv;</a></p>
  <div id="source-server.MyServer.end_headers" class="source">
    <pre><code>def end_headers(self):
    """Send the blank line ending the MIME headers."""
    if self.request_version != 'HTTP/0.9':
        self._headers_buffer.append(b"\r\n")
        self.flush_headers()
</code></pre>
  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="server.MyServer.finish">
    <p>def <span class="ident">finish</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-server.MyServer.finish', this);">Show source &equiv;</a></p>
  <div id="source-server.MyServer.finish" class="source">
    <pre><code>def finish(self):
    if not self.wfile.closed:
        try:
            self.wfile.flush()
        except socket.error:
            # A final socket error may have occurred here, such as
            # the local error ECONNABORTED.
            pass
    self.wfile.close()
    self.rfile.close()
</code></pre>
  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="server.MyServer.flush_headers">
    <p>def <span class="ident">flush_headers</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-server.MyServer.flush_headers', this);">Show source &equiv;</a></p>
  <div id="source-server.MyServer.flush_headers" class="source">
    <pre><code>def flush_headers(self):
    if hasattr(self, '_headers_buffer'):
        self.wfile.write(b"".join(self._headers_buffer))
        self._headers_buffer = []
</code></pre>
  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="server.MyServer.handle">
    <p>def <span class="ident">handle</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Handle multiple requests if necessary.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-server.MyServer.handle', this);">Show source &equiv;</a></p>
  <div id="source-server.MyServer.handle" class="source">
    <pre><code>def handle(self):
    """Handle multiple requests if necessary."""
    self.close_connection = True
    self.handle_one_request()
    while not self.close_connection:
        self.handle_one_request()
</code></pre>
  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="server.MyServer.handle_expect_100">
    <p>def <span class="ident">handle_expect_100</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Decide what to do with an "Expect: 100-continue" header.</p>
<p>If the client is expecting a 100 Continue response, we must
respond with either a 100 Continue or a final response before
waiting for the request body. The default is to always respond
with a 100 Continue. You can behave differently (for example,
reject unauthorized requests) by overriding this method.</p>
<p>This method should either return True (possibly after sending
a 100 Continue response) or send an error response and return
False.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-server.MyServer.handle_expect_100', this);">Show source &equiv;</a></p>
  <div id="source-server.MyServer.handle_expect_100" class="source">
    <pre><code>def handle_expect_100(self):
    """Decide what to do with an "Expect: 100-continue" header.
    If the client is expecting a 100 Continue response, we must
    respond with either a 100 Continue or a final response before
    waiting for the request body. The default is to always respond
    with a 100 Continue. You can behave differently (for example,
    reject unauthorized requests) by overriding this method.
    This method should either return True (possibly after sending
    a 100 Continue response) or send an error response and return
    False.
    """
    self.send_response_only(HTTPStatus.CONTINUE)
    self.end_headers()
    return True
</code></pre>
  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="server.MyServer.handle_one_request">
    <p>def <span class="ident">handle_one_request</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Handle a single HTTP request.</p>
<p>You normally don't need to override this method; see the class
<strong>doc</strong> string for information on how to handle specific HTTP
commands such as GET and POST.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-server.MyServer.handle_one_request', this);">Show source &equiv;</a></p>
  <div id="source-server.MyServer.handle_one_request" class="source">
    <pre><code>def handle_one_request(self):
    """Handle a single HTTP request.
    You normally don't need to override this method; see the class
    __doc__ string for information on how to handle specific HTTP
    commands such as GET and POST.
    """
    try:
        self.raw_requestline = self.rfile.readline(65537)
        if len(self.raw_requestline) > 65536:
            self.requestline = ''
            self.request_version = ''
            self.command = ''
            self.send_error(HTTPStatus.REQUEST_URI_TOO_LONG)
            return
        if not self.raw_requestline:
            self.close_connection = True
            return
        if not self.parse_request():
            # An error code has been sent, just exit
            return
        mname = 'do_' + self.command
        if not hasattr(self, mname):
            self.send_error(
                HTTPStatus.NOT_IMPLEMENTED,
                "Unsupported method (%r)" % self.command)
            return
        method = getattr(self, mname)
        method()
        self.wfile.flush() #actually send the response if not already done.
    except socket.timeout as e:
        #a read or a write timed out.  Discard this connection
        self.log_error("Request timed out: %r", e)
        self.close_connection = True
        return
</code></pre>
  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="server.MyServer.log_date_time_string">
    <p>def <span class="ident">log_date_time_string</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Return the current time formatted for logging.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-server.MyServer.log_date_time_string', this);">Show source &equiv;</a></p>
  <div id="source-server.MyServer.log_date_time_string" class="source">
    <pre><code>def log_date_time_string(self):
    """Return the current time formatted for logging."""
    now = time.time()
    year, month, day, hh, mm, ss, x, y, z = time.localtime(now)
    s = "%02d/%3s/%04d %02d:%02d:%02d" % (
            day, self.monthname[month], year, hh, mm, ss)
    return s
</code></pre>
  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="server.MyServer.log_error">
    <p>def <span class="ident">log_error</span>(</p><p>self, format, *args)</p>
    </div>
    

    
  
    <div class="desc"><p>Log an error.</p>
<p>This is called when a request cannot be fulfilled.  By
default it passes the message on to log_message().</p>
<p>Arguments are the same as for log_message().</p>
<p>XXX This should go to the separate error log.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-server.MyServer.log_error', this);">Show source &equiv;</a></p>
  <div id="source-server.MyServer.log_error" class="source">
    <pre><code>def log_error(self, format, *args):
    """Log an error.
    This is called when a request cannot be fulfilled.  By
    default it passes the message on to log_message().
    Arguments are the same as for log_message().
    XXX This should go to the separate error log.
    """
    self.log_message(format, *args)
</code></pre>
  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="server.MyServer.log_message">
    <p>def <span class="ident">log_message</span>(</p><p>self, format, *args)</p>
    </div>
    

    
  
    <div class="desc"><p>Log an arbitrary message.</p>
<p>This is used by all other logging functions.  Override
it if you have specific logging wishes.</p>
<p>The first argument, FORMAT, is a format string for the
message to be logged.  If the format string contains
any % escapes requiring parameters, they should be
specified as subsequent arguments (it's just like
printf!).</p>
<p>The client ip and current date/time are prefixed to
every message.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-server.MyServer.log_message', this);">Show source &equiv;</a></p>
  <div id="source-server.MyServer.log_message" class="source">
    <pre><code>def log_message(self, format, *args):
    """Log an arbitrary message.
    This is used by all other logging functions.  Override
    it if you have specific logging wishes.
    The first argument, FORMAT, is a format string for the
    message to be logged.  If the format string contains
    any % escapes requiring parameters, they should be
    specified as subsequent arguments (it's just like
    printf!).
    The client ip and current date/time are prefixed to
    every message.
    """
    sys.stderr.write("%s - - [%s] %s\n" %
                     (self.address_string(),
                      self.log_date_time_string(),
                      format%args))
</code></pre>
  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="server.MyServer.log_request">
    <p>def <span class="ident">log_request</span>(</p><p>self, code=&#39;-&#39;, size=&#39;-&#39;)</p>
    </div>
    

    
  
    <div class="desc"><p>Log an accepted request.</p>
<p>This is called by send_response().</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-server.MyServer.log_request', this);">Show source &equiv;</a></p>
  <div id="source-server.MyServer.log_request" class="source">
    <pre><code>def log_request(self, code='-', size='-'):
    """Log an accepted request.
    This is called by send_response().
    """
    if isinstance(code, HTTPStatus):
        code = code.value
    self.log_message('"%s" %s %s',
                     self.requestline, str(code), str(size))
</code></pre>
  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="server.MyServer.parse_request">
    <p>def <span class="ident">parse_request</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Parse a request (internal).</p>
<p>The request should be stored in self.raw_requestline; the results
are in self.command, self.path, self.request_version and
self.headers.</p>
<p>Return True for success, False for failure; on failure, an
error is sent back.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-server.MyServer.parse_request', this);">Show source &equiv;</a></p>
  <div id="source-server.MyServer.parse_request" class="source">
    <pre><code>def parse_request(self):
    """Parse a request (internal).
    The request should be stored in self.raw_requestline; the results
    are in self.command, self.path, self.request_version and
    self.headers.
    Return True for success, False for failure; on failure, an
    error is sent back.
    """
    self.command = None  # set in case of error on the first line
    self.request_version = version = self.default_request_version
    self.close_connection = True
    requestline = str(self.raw_requestline, 'iso-8859-1')
    requestline = requestline.rstrip('\r\n')
    self.requestline = requestline
    words = requestline.split()
    if len(words) == 3:
        command, path, version = words
        if version[:5] != 'HTTP/':
            self.send_error(
                HTTPStatus.BAD_REQUEST,
                "Bad request version (%r)" % version)
            return False
        try:
            base_version_number = version.split('/', 1)[1]
            version_number = base_version_number.split(".")
            # RFC 2145 section 3.1 says there can be only one "." and
            #   - major and minor numbers MUST be treated as
            #      separate integers;
            #   - HTTP/2.4 is a lower version than HTTP/2.13, which in
            #      turn is lower than HTTP/12.3;
            #   - Leading zeros MUST be ignored by recipients.
            if len(version_number) != 2:
                raise ValueError
            version_number = int(version_number[0]), int(version_number[1])
        except (ValueError, IndexError):
            self.send_error(
                HTTPStatus.BAD_REQUEST,
                "Bad request version (%r)" % version)
            return False
        if version_number >= (1, 1) and self.protocol_version >= "HTTP/1.1":
            self.close_connection = False
        if version_number >= (2, 0):
            self.send_error(
                HTTPStatus.HTTP_VERSION_NOT_SUPPORTED,
                "Invalid HTTP Version (%s)" % base_version_number)
            return False
    elif len(words) == 2:
        command, path = words
        self.close_connection = True
        if command != 'GET':
            self.send_error(
                HTTPStatus.BAD_REQUEST,
                "Bad HTTP/0.9 request type (%r)" % command)
            return False
    elif not words:
        return False
    else:
        self.send_error(
            HTTPStatus.BAD_REQUEST,
            "Bad request syntax (%r)" % requestline)
        return False
    self.command, self.path, self.request_version = command, path, version
    # Examine the headers and look for a Connection directive.
    try:
        self.headers = http.client.parse_headers(self.rfile,
                                                 _class=self.MessageClass)
    except http.client.LineTooLong:
        self.send_error(
            HTTPStatus.BAD_REQUEST,
            "Line too long")
        return False
    except http.client.HTTPException as err:
        self.send_error(
            HTTPStatus.REQUEST_HEADER_FIELDS_TOO_LARGE,
            "Too many headers",
            str(err)
        )
        return False
    conntype = self.headers.get('Connection', "")
    if conntype.lower() == 'close':
        self.close_connection = True
    elif (conntype.lower() == 'keep-alive' and
          self.protocol_version >= "HTTP/1.1"):
        self.close_connection = False
    # Examine the headers and look for an Expect directive
    expect = self.headers.get('Expect', "")
    if (expect.lower() == "100-continue" and
            self.protocol_version >= "HTTP/1.1" and
            self.request_version >= "HTTP/1.1"):
        if not self.handle_expect_100():
            return False
    return True
</code></pre>
  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="server.MyServer.send_error">
    <p>def <span class="ident">send_error</span>(</p><p>self, code, message=None, explain=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Send and log an error reply.</p>
<p>Arguments are
<em> code:    an HTTP error code
           3 digits
</em> message: a simple optional 1 line reason phrase.
           <em>( HTAB / SP / VCHAR / %x80-FF )
           defaults to short entry matching the response code
</em> explain: a detailed message defaults to the long entry
           matching the response code.</p>
<p>This sends an error response (so it must be called before any
output has been generated), logs the error, and finally sends
a piece of HTML explaining the error to the user.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-server.MyServer.send_error', this);">Show source &equiv;</a></p>
  <div id="source-server.MyServer.send_error" class="source">
    <pre><code>def send_error(self, code, message=None, explain=None):
    """Send and log an error reply.
    Arguments are
    * code:    an HTTP error code
               3 digits
    * message: a simple optional 1 line reason phrase.
               *( HTAB / SP / VCHAR / %x80-FF )
               defaults to short entry matching the response code
    * explain: a detailed message defaults to the long entry
               matching the response code.
    This sends an error response (so it must be called before any
    output has been generated), logs the error, and finally sends
    a piece of HTML explaining the error to the user.
    """
    try:
        shortmsg, longmsg = self.responses[code]
    except KeyError:
        shortmsg, longmsg = '???', '???'
    if message is None:
        message = shortmsg
    if explain is None:
        explain = longmsg
    self.log_error("code %d, message %s", code, message)
    self.send_response(code, message)
    self.send_header('Connection', 'close')
    # Message body is omitted for cases described in:
    #  - RFC7230: 3.3. 1xx, 204(No Content), 304(Not Modified)
    #  - RFC7231: 6.3.6. 205(Reset Content)
    body = None
    if (code >= 200 and
        code not in (HTTPStatus.NO_CONTENT,
                     HTTPStatus.RESET_CONTENT,
                     HTTPStatus.NOT_MODIFIED)):
        # HTML encode to prevent Cross Site Scripting attacks
        # (see bug #1100201)
        content = (self.error_message_format % {
            'code': code,
            'message': _quote_html(message),
            'explain': _quote_html(explain)
        })
        body = content.encode('UTF-8', 'replace')
        self.send_header("Content-Type", self.error_content_type)
        self.send_header('Content-Length', int(len(body)))
    self.end_headers()
    if self.command != 'HEAD' and body:
        self.wfile.write(body)
</code></pre>
  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="server.MyServer.send_header">
    <p>def <span class="ident">send_header</span>(</p><p>self, keyword, value)</p>
    </div>
    

    
  
    <div class="desc"><p>Send a MIME header to the headers buffer.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-server.MyServer.send_header', this);">Show source &equiv;</a></p>
  <div id="source-server.MyServer.send_header" class="source">
    <pre><code>def send_header(self, keyword, value):
    """Send a MIME header to the headers buffer."""
    if self.request_version != 'HTTP/0.9':
        if not hasattr(self, '_headers_buffer'):
            self._headers_buffer = []
        self._headers_buffer.append(
            ("%s: %s\r\n" % (keyword, value)).encode('latin-1', 'strict'))
    if keyword.lower() == 'connection':
        if value.lower() == 'close':
            self.close_connection = True
        elif value.lower() == 'keep-alive':
            self.close_connection = False
</code></pre>
  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="server.MyServer.send_response">
    <p>def <span class="ident">send_response</span>(</p><p>self, code, message=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Add the response header to the headers buffer and log the
response code.</p>
<p>Also send two standard headers with the server software
version and the current date.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-server.MyServer.send_response', this);">Show source &equiv;</a></p>
  <div id="source-server.MyServer.send_response" class="source">
    <pre><code>def send_response(self, code, message=None):
    """Add the response header to the headers buffer and log the
    response code.
    Also send two standard headers with the server software
    version and the current date.
    """
    self.log_request(code)
    self.send_response_only(code, message)
    self.send_header('Server', self.version_string())
    self.send_header('Date', self.date_time_string())
</code></pre>
  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="server.MyServer.send_response_only">
    <p>def <span class="ident">send_response_only</span>(</p><p>self, code, message=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Send the response header only.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-server.MyServer.send_response_only', this);">Show source &equiv;</a></p>
  <div id="source-server.MyServer.send_response_only" class="source">
    <pre><code>def send_response_only(self, code, message=None):
    """Send the response header only."""
    if message is None:
        if code in self.responses:
            message = self.responses[code][0]
        else:
            message = ''
    if self.request_version != 'HTTP/0.9':
        if not hasattr(self, '_headers_buffer'):
            self._headers_buffer = []
        self._headers_buffer.append(("%s %d %s\r\n" %
                (self.protocol_version, code, message)).encode(
                    'latin-1', 'strict'))
</code></pre>
  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="server.MyServer.setup">
    <p>def <span class="ident">setup</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-server.MyServer.setup', this);">Show source &equiv;</a></p>
  <div id="source-server.MyServer.setup" class="source">
    <pre><code>def setup(self):
    self.connection = self.request
    if self.timeout is not None:
        self.connection.settimeout(self.timeout)
    if self.disable_nagle_algorithm:
        self.connection.setsockopt(socket.IPPROTO_TCP,
                                   socket.TCP_NODELAY, True)
    self.rfile = self.connection.makefile('rb', self.rbufsize)
    self.wfile = self.connection.makefile('wb', self.wbufsize)
</code></pre>
  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="server.MyServer.version_string">
    <p>def <span class="ident">version_string</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Return the server software version string.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-server.MyServer.version_string', this);">Show source &equiv;</a></p>
  <div id="source-server.MyServer.version_string" class="source">
    <pre><code>def version_string(self):
    """Return the server software version string."""
    return self.server_version + ' ' + self.sys_version
</code></pre>
  </div>
</div>

  </div>
  
      </div>
      </div>
      
      <div class="item">
      <p id="server.ThreadingSimpleServer" class="name">class <span class="ident">ThreadingSimpleServer</span></p>
      
  
    <div class="desc"><p>Handles the multithreading of the web server.</p>
<p>Args:
    ThreadingMixIn (tuple): information about the ip and port
    http.server.HTTPServer (handler)</p>
<p>return:</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-server.ThreadingSimpleServer', this);">Show source &equiv;</a></p>
  <div id="source-server.ThreadingSimpleServer" class="source">
    <pre><code>class ThreadingSimpleServer(ThreadingMixIn, http.server.HTTPServer):
    """
    Handles the multithreading of the web server.
    
    Args:
        ThreadingMixIn (tuple): information about the ip and port
        http.server.HTTPServer (handler)
    
    return:
    """
    pass
</code></pre>
  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#server.ThreadingSimpleServer">ThreadingSimpleServer</a></li>
          <li>socketserver.ThreadingMixIn</li>
          <li>http.server.HTTPServer</li>
          <li>socketserver.TCPServer</li>
          <li>socketserver.BaseServer</li>
          <li>builtins.object</li>
          </ul>
          <h3>Class variables</h3>
            <div class="item">
            <p id="server.ThreadingSimpleServer.address_family" class="name">var <span class="ident">address_family</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="server.ThreadingSimpleServer.allow_reuse_address" class="name">var <span class="ident">allow_reuse_address</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="server.ThreadingSimpleServer.daemon_threads" class="name">var <span class="ident">daemon_threads</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="server.ThreadingSimpleServer.request_queue_size" class="name">var <span class="ident">request_queue_size</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="server.ThreadingSimpleServer.socket_type" class="name">var <span class="ident">socket_type</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="server.ThreadingSimpleServer.timeout" class="name">var <span class="ident">timeout</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="server.ThreadingSimpleServer.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, server_address, RequestHandlerClass, bind_and_activate=True)</p>
    </div>
    

    
  
    <div class="desc"><p>Constructor.  May be extended, do not override.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-server.ThreadingSimpleServer.__init__', this);">Show source &equiv;</a></p>
  <div id="source-server.ThreadingSimpleServer.__init__" class="source">
    <pre><code>def __init__(self, server_address, RequestHandlerClass, bind_and_activate=True):
    """Constructor.  May be extended, do not override."""
    BaseServer.__init__(self, server_address, RequestHandlerClass)
    self.socket = socket.socket(self.address_family,
                                self.socket_type)
    if bind_and_activate:
        try:
            self.server_bind()
            self.server_activate()
        except:
            self.server_close()
            raise
</code></pre>
  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="server.ThreadingSimpleServer.close_request">
    <p>def <span class="ident">close_request</span>(</p><p>self, request)</p>
    </div>
    

    
  
    <div class="desc"><p>Called to clean up an individual request.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-server.ThreadingSimpleServer.close_request', this);">Show source &equiv;</a></p>
  <div id="source-server.ThreadingSimpleServer.close_request" class="source">
    <pre><code>def close_request(self, request):
    """Called to clean up an individual request."""
    request.close()
</code></pre>
  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="server.ThreadingSimpleServer.fileno">
    <p>def <span class="ident">fileno</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Return socket file number.</p>
<p>Interface required by selector.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-server.ThreadingSimpleServer.fileno', this);">Show source &equiv;</a></p>
  <div id="source-server.ThreadingSimpleServer.fileno" class="source">
    <pre><code>def fileno(self):
    """Return socket file number.
    Interface required by selector.
    """
    return self.socket.fileno()
</code></pre>
  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="server.ThreadingSimpleServer.finish_request">
    <p>def <span class="ident">finish_request</span>(</p><p>self, request, client_address)</p>
    </div>
    

    
  
    <div class="desc"><p>Finish one request by instantiating RequestHandlerClass.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-server.ThreadingSimpleServer.finish_request', this);">Show source &equiv;</a></p>
  <div id="source-server.ThreadingSimpleServer.finish_request" class="source">
    <pre><code>def finish_request(self, request, client_address):
    """Finish one request by instantiating RequestHandlerClass."""
    self.RequestHandlerClass(request, client_address, self)
</code></pre>
  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="server.ThreadingSimpleServer.get_request">
    <p>def <span class="ident">get_request</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Get the request and client address from the socket.</p>
<p>May be overridden.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-server.ThreadingSimpleServer.get_request', this);">Show source &equiv;</a></p>
  <div id="source-server.ThreadingSimpleServer.get_request" class="source">
    <pre><code>def get_request(self):
    """Get the request and client address from the socket.
    May be overridden.
    """
    return self.socket.accept()
</code></pre>
  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="server.ThreadingSimpleServer.handle_error">
    <p>def <span class="ident">handle_error</span>(</p><p>self, request, client_address)</p>
    </div>
    

    
  
    <div class="desc"><p>Handle an error gracefully.  May be overridden.</p>
<p>The default is to print a traceback and continue.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-server.ThreadingSimpleServer.handle_error', this);">Show source &equiv;</a></p>
  <div id="source-server.ThreadingSimpleServer.handle_error" class="source">
    <pre><code>def handle_error(self, request, client_address):
    """Handle an error gracefully.  May be overridden.
    The default is to print a traceback and continue.
    """
    print('-'*40)
    print('Exception happened during processing of request from', end=' ')
    print(client_address)
    import traceback
    traceback.print_exc() # XXX But this goes to stderr!
    print('-'*40)
</code></pre>
  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="server.ThreadingSimpleServer.handle_request">
    <p>def <span class="ident">handle_request</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Handle one request, possibly blocking.</p>
<p>Respects self.timeout.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-server.ThreadingSimpleServer.handle_request', this);">Show source &equiv;</a></p>
  <div id="source-server.ThreadingSimpleServer.handle_request" class="source">
    <pre><code>def handle_request(self):
    """Handle one request, possibly blocking.
    Respects self.timeout.
    """
    # Support people who used socket.settimeout() to escape
    # handle_request before self.timeout was available.
    timeout = self.socket.gettimeout()
    if timeout is None:
        timeout = self.timeout
    elif self.timeout is not None:
        timeout = min(timeout, self.timeout)
    if timeout is not None:
        deadline = time() + timeout
    # Wait until a request arrives or the timeout expires - the loop is
    # necessary to accommodate early wakeups due to EINTR.
    with _ServerSelector() as selector:
        selector.register(self, selectors.EVENT_READ)
        while True:
            ready = selector.select(timeout)
            if ready:
                return self._handle_request_noblock()
            else:
                if timeout is not None:
                    timeout = deadline - time()
                    if timeout < 0:
                        return self.handle_timeout()
</code></pre>
  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="server.ThreadingSimpleServer.handle_timeout">
    <p>def <span class="ident">handle_timeout</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Called if no new request arrives within self.timeout.</p>
<p>Overridden by ForkingMixIn.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-server.ThreadingSimpleServer.handle_timeout', this);">Show source &equiv;</a></p>
  <div id="source-server.ThreadingSimpleServer.handle_timeout" class="source">
    <pre><code>def handle_timeout(self):
    """Called if no new request arrives within self.timeout.
    Overridden by ForkingMixIn.
    """
    pass
</code></pre>
  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="server.ThreadingSimpleServer.process_request">
    <p>def <span class="ident">process_request</span>(</p><p>self, request, client_address)</p>
    </div>
    

    
  
    <div class="desc"><p>Start a new thread to process the request.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-server.ThreadingSimpleServer.process_request', this);">Show source &equiv;</a></p>
  <div id="source-server.ThreadingSimpleServer.process_request" class="source">
    <pre><code>def process_request(self, request, client_address):
    """Start a new thread to process the request."""
    t = threading.Thread(target = self.process_request_thread,
                         args = (request, client_address))
    t.daemon = self.daemon_threads
    t.start()
</code></pre>
  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="server.ThreadingSimpleServer.process_request_thread">
    <p>def <span class="ident">process_request_thread</span>(</p><p>self, request, client_address)</p>
    </div>
    

    
  
    <div class="desc"><p>Same as in BaseServer but as a thread.</p>
<p>In addition, exception handling is done here.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-server.ThreadingSimpleServer.process_request_thread', this);">Show source &equiv;</a></p>
  <div id="source-server.ThreadingSimpleServer.process_request_thread" class="source">
    <pre><code>def process_request_thread(self, request, client_address):
    """Same as in BaseServer but as a thread.
    In addition, exception handling is done here.
    """
    try:
        self.finish_request(request, client_address)
        self.shutdown_request(request)
    except:
        self.handle_error(request, client_address)
        self.shutdown_request(request)
</code></pre>
  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="server.ThreadingSimpleServer.serve_forever">
    <p>def <span class="ident">serve_forever</span>(</p><p>self, poll_interval=0.5)</p>
    </div>
    

    
  
    <div class="desc"><p>Handle one request at a time until shutdown.</p>
<p>Polls for shutdown every poll_interval seconds. Ignores
self.timeout. If you need to do periodic tasks, do them in
another thread.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-server.ThreadingSimpleServer.serve_forever', this);">Show source &equiv;</a></p>
  <div id="source-server.ThreadingSimpleServer.serve_forever" class="source">
    <pre><code>def serve_forever(self, poll_interval=0.5):
    """Handle one request at a time until shutdown.
    Polls for shutdown every poll_interval seconds. Ignores
    self.timeout. If you need to do periodic tasks, do them in
    another thread.
    """
    self.__is_shut_down.clear()
    try:
        # XXX: Consider using another file descriptor or connecting to the
        # socket to wake this up instead of polling. Polling reduces our
        # responsiveness to a shutdown request and wastes cpu at all other
        # times.
        with _ServerSelector() as selector:
            selector.register(self, selectors.EVENT_READ)
            while not self.__shutdown_request:
                ready = selector.select(poll_interval)
                if ready:
                    self._handle_request_noblock()
                self.service_actions()
    finally:
        self.__shutdown_request = False
        self.__is_shut_down.set()
</code></pre>
  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="server.ThreadingSimpleServer.server_activate">
    <p>def <span class="ident">server_activate</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Called by constructor to activate the server.</p>
<p>May be overridden.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-server.ThreadingSimpleServer.server_activate', this);">Show source &equiv;</a></p>
  <div id="source-server.ThreadingSimpleServer.server_activate" class="source">
    <pre><code>def server_activate(self):
    """Called by constructor to activate the server.
    May be overridden.
    """
    self.socket.listen(self.request_queue_size)
</code></pre>
  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="server.ThreadingSimpleServer.server_bind">
    <p>def <span class="ident">server_bind</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Override server_bind to store the server name.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-server.ThreadingSimpleServer.server_bind', this);">Show source &equiv;</a></p>
  <div id="source-server.ThreadingSimpleServer.server_bind" class="source">
    <pre><code>def server_bind(self):
    """Override server_bind to store the server name."""
    socketserver.TCPServer.server_bind(self)
    host, port = self.socket.getsockname()[:2]
    self.server_name = socket.getfqdn(host)
    self.server_port = port
</code></pre>
  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="server.ThreadingSimpleServer.server_close">
    <p>def <span class="ident">server_close</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Called to clean-up the server.</p>
<p>May be overridden.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-server.ThreadingSimpleServer.server_close', this);">Show source &equiv;</a></p>
  <div id="source-server.ThreadingSimpleServer.server_close" class="source">
    <pre><code>def server_close(self):
    """Called to clean-up the server.
    May be overridden.
    """
    self.socket.close()
</code></pre>
  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="server.ThreadingSimpleServer.service_actions">
    <p>def <span class="ident">service_actions</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Called by the serve_forever() loop.</p>
<p>May be overridden by a subclass / Mixin to implement any code that
needs to be run during the loop.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-server.ThreadingSimpleServer.service_actions', this);">Show source &equiv;</a></p>
  <div id="source-server.ThreadingSimpleServer.service_actions" class="source">
    <pre><code>def service_actions(self):
    """Called by the serve_forever() loop.
    May be overridden by a subclass / Mixin to implement any code that
    needs to be run during the loop.
    """
    pass
</code></pre>
  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="server.ThreadingSimpleServer.shutdown">
    <p>def <span class="ident">shutdown</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Stops the serve_forever loop.</p>
<p>Blocks until the loop has finished. This must be called while
serve_forever() is running in another thread, or it will
deadlock.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-server.ThreadingSimpleServer.shutdown', this);">Show source &equiv;</a></p>
  <div id="source-server.ThreadingSimpleServer.shutdown" class="source">
    <pre><code>def shutdown(self):
    """Stops the serve_forever loop.
    Blocks until the loop has finished. This must be called while
    serve_forever() is running in another thread, or it will
    deadlock.
    """
    self.__shutdown_request = True
    self.__is_shut_down.wait()
</code></pre>
  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="server.ThreadingSimpleServer.shutdown_request">
    <p>def <span class="ident">shutdown_request</span>(</p><p>self, request)</p>
    </div>
    

    
  
    <div class="desc"><p>Called to shutdown and close an individual request.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-server.ThreadingSimpleServer.shutdown_request', this);">Show source &equiv;</a></p>
  <div id="source-server.ThreadingSimpleServer.shutdown_request" class="source">
    <pre><code>def shutdown_request(self, request):
    """Called to shutdown and close an individual request."""
    try:
        #explicitly shutdown.  socket.close() merely releases
        #the socket and waits for GC to perform the actual close.
        request.shutdown(socket.SHUT_WR)
    except OSError:
        pass #some platforms may raise ENOTCONN here
    self.close_request(request)
</code></pre>
  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="server.ThreadingSimpleServer.verify_request">
    <p>def <span class="ident">verify_request</span>(</p><p>self, request, client_address)</p>
    </div>
    

    
  
    <div class="desc"><p>Verify the request.  May be overridden.</p>
<p>Return True if we should proceed with this request.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-server.ThreadingSimpleServer.verify_request', this);">Show source &equiv;</a></p>
  <div id="source-server.ThreadingSimpleServer.verify_request" class="source">
    <pre><code>def verify_request(self, request, client_address):
    """Verify the request.  May be overridden.
    Return True if we should proceed with this request.
    """
    return True
</code></pre>
  </div>
</div>

  </div>
  
      </div>
      </div>

  </section>

    </article>
  <div class="clear"> </div>
  <footer id="footer">
    <p>
      Documentation generated by
      <a href="https://github.com/BurntSushi/pdoc">pdoc 0.3.2</a>
    </p>

    <p>pdoc is in the public domain with the
      <a href="http://unlicense.org">UNLICENSE</a></p>

    <p>Design by <a href="http://nadh.in">Kailash Nadh</a></p>
  </footer>
</div>
</body>
</html>
